version: "3.7"

services:
  bot:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      # Mount the source code so that we can edit it locally while it runs in the container
      - ./src/:/usr/src/app/src
    user: root
    environment:
      - DISCORD_BOT_TOKEN
      - PAPERTRAIL_HOST
      - PAPERTRAIL_PORT
    volumes:
      # Preserve the settings database on the host filesystem
      - ./settings.db:/usr/src/app/settings.db:rw
    command: "npm run host"
    restart: unless-stopped:0
